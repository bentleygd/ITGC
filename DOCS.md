# ITGCLIB Documentation

<h1>ITGCLIB Classes</h2>
<h2>ITGCAudit</h2>
The ITGCAudit class is a super class that is meant to be inherited by sub-classes to allow those sub-classes to be able to use the class methods and instances variables (detailed below).  This is done to reduce duplicate code.

**Class Methods**:  
- **ITGCAudit.get_ad_users** \- This method retrieves users from specific OUs (specified in the [ldap][search_ou] portion of the configuration) and stores them in the self.ad_users variable.  It returns the self.ad_users variable as user_list.  
- **ITGCAudit.get_audit_ex** \- This method performs a list comparison and appends the delta to the audit_ex variable (a list).  The audit_ex variable is returned when this method is called.  

**Class Variables**:  
- **ITGCAudit.host_list** \- A dictionary object that contains a list object of reachable hosts and a list object of unreachable hosts.  This attribute is utilized by the sub-classes of the ITGCAudit class.  
- **ITGCAudit.ad_users** \- A list object that contains the users from AD that are gathered by the get_ad_users() method.  
- **ITGCAudit.conf** \- A string that represents the location of a configuration file that is called by the ConfigParser class (specifically, ConfigParser.read()) from the configparser module.  An example configuration is provided in example.conf.  
- **ITGCAudit.log** \- A call to the getLogger function from the logging module.  This allows for easy logging calls by referencing self.log in subclasses.

<h3>ITGCAudit Method Documentation</h3>  

**get_ad_users()**

Keyword Arguments:  
- None.

Returns:  
- user_list, a list object containing all users from the OUs specified in [ldap][search_ou] section of the configuration.  

The get_ad_users method is largely depedent on the [ldap] section of the configuration file specified in self.config.  If the config file is not present and formatted in a manner similar to what is included in example.conf, the connection to LDAP will not succeed and will fail.  

**Code Example**:  

```python
    audit_obj = ITGCAudit()
    ad_users = audit_obj.get_ad_users()

    for user in ad_users:
        print('This is a user from active directory', user)
```

**get_audit_ex**(local_users, ad_users, exclusions) 

Keyword Arguments:
- local_users - A list object containing all the users from a local system.  
- ad_users - A list object containing the users from active directory.  
- exclusions - A list object of user IDs that are excluded from the audit.  

Returns:
- audit_ex, a list object containing exceptions from a list comparison.  

This method is used primarily to compare the local users on a system to the list of users from AD generated by the get_ad_users method.  This method is heavily dependent on the specifc operating system portion of the configuration.  Any local account (that does not have a corresponing AD account) that needs to be excluded from that audit must be in the corresponding exlcusion section of the configuration (example: config[linux][exclusions]).  

**Code Example**
```python
    audit_obj = ITGCAudit()
    ad_users = audit_obj.get_ad_users()
    local_accounts = ['bob', 'alice', 'tom']
    excluded_users = ['tom'] # Exclusions are normally obtained from the config.
    no_ad_account = audit_obj.get_audit_ex(
        local_accounts, ad_users, excluded_users
    )
    for bad_user in no_ad_account:
        print('%s does not have an AD account.', bad_user)
```  
